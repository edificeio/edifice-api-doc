---
openapi: 3.0.0
info:
  title: Edifice - Conversation - API ðŸš§ðŸš§
  description: Conversation is the internal messaging application of NEO
  version: 4.10.0
servers:
  - url: /
tags:
  - name: conversation
    description: Api for conversation
  - name: message
    description: Api for message in the conversation
  - name: thread
    description: Api for thread conversation
  - name: folder
    description: Api for folder in the conversation
paths:
  /conversation/visible:
    get:
      tags:
        - conversation
      summary: Search visible users and groups
      description: "If a search keyword is passed as queryParam, then only users with displayname matching that keyword are returned."
      parameters:
        - name: search
          in: query
          required: false
          style: form
          explode: true
          schema:
            type: string
      responses:
        "200":
          description: Visible users (matching search's keyword) and visible groups
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/conversationVisible"
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/draft:
    post:
      tags:
        - conversation
      summary: Create a draft message
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                body:
                  type: string
                  example: '<div class="ng-scope"><br></div><div class="signature new-signature ng-scope"></div>'
                to:
                  type: array
                  items:
                    type: string
                  example: []
                cc:
                  type: array
                  items:
                    type: string
                  example: []
                cci:
                  type: array
                  items:
                    type: string
                  example: []
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    example: "e06c7b27-f611-4239-8ad9-acc5935c8452"
                required:
                  - id
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  
  /conversation/externe:
    post:
      tags:
        - conversation
      summary: Send a message from an external source
      description: |
        Allows an external system to send a message to a user via the application.  
        All fields are required.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - messageBody
                - subject
                - to
                - from
                - username
              properties:
                messageBody:
                  type: string
                  description: HTML content of the message.
                  example: "<h3>Bonjour,</h3><p>Ceci est un message de test avec un contexte</p><p><br/><div>Consultez l'application test</div></p><p><a href=\"https://www.google.com\">Google</a></p><p><img src=\"https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png\" alt=\"Google Logo\" /></p>"
                subject:
                  type: string
                  description: Subject of the message.
                  example: "Test Notification"
                to:
                  type: string
                  description: ENT ID of the recipient user.
                  example: "user-ent-id-123"
                from:
                  type: string
                  description: ENT ID of the sender user.
                  example: "sender-ent-id-456"
                username:
                  type: string
                  description: Username (used as sender name).
                  example: "system@example.com"
      responses:
        '200':
          description: Message successfully sent
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "ok"
                  result:
                    type: array
                    items:
                      type: object
                      example: {}
        '400':
          description: Bad Request (missing or invalid fields)
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Missing required fields"

        '302':
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/*
  /conversation/draft/{id}:
    put:
      tags:
        - conversation
      summary: Update a draft message
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: ID of the draft message to update
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                body:
                  type: string
                  example: '<div class="ng-scope"><br></div><div class="signature new-signature ng-scope"></div>'
                to:
                  type: array
                  items:
                    type: string
                  example:
                    - "e120c8be-ce7b-4f2d-9926-38fc4b9c8126"
                cc:
                  type: array
                  items:
                    type: string
                  example: []
                cci:
                  type: array
                  items:
                    type: string
                  example: []
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema: {}

        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/send:
    post:
      tags:
        - conversation
      summary: Send a message
      parameters:
        - in: query
          name: id
          schema:
            type: string
          description: ID of the draft message to send
          required: true
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                body:
                  type: string
                  example: '<div class="ng-scope">TEst message</div><div class="signature new-signature ng-scope"></div>'
                to:
                  type: array
                  items:
                    type: string
                  example:
                    - "e120c8be-ce7b-4f2d-9926-38fc4b9c8126"
                cc:
                  type: array
                  items:
                    type: string
                  example: []
                cci:
                  type: array
                  items:
                    type: string
                  example: []
                subject:
                  type: string
                  example: "Test"
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    example: "e06c7b27-f611-4239-8ad9-acc5935c8452"
                  subject:
                    type: string
                    example: "Test"
                  body:
                    type: string
                    example: '<div class="ng-scope">TEst message</div><div class="signature new-signature ng-scope"></div>'
                  thread_id:
                    type: string
                    example: "e06c7b27-f611-4239-8ad9-acc5935c8452"
                  inactive:
                    type: array
                  undelivered:
                    type: array
                  sent:
                    type: integer
                    example: 1
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/list/{folder}:
    get:
      tags:
        - folder
      summary: Get a list of messages in the inbox
      parameters:
        - name: folder
          in: path
          required: true
          style: simple
          explode: false
          schema:
            type: string
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                      example: "148b7b23-9154-4bfa-9a3f-934a65c6784a"
                    subject:
                      type: string
                      example: "Conseils de classe du deuxiÃ¨me trimestre"
                    from:
                      type: string
                      example: "4e6f1a98-4696-4b9b-be8f-18b3a372a555"
                    state:
                      type: string
                      example: "SENT"
                    fromName:
                      type: string
                      example: null
                    to:
                      type: array
                      items:
                        type: string
                      example:
                        - "92766-1510043922665"
                    toName:
                      type: string
                      example: null
                    cc:
                      type: array
                      items:
                        type: string
                      example: []
                    ccName:
                      type: string
                      example: null
                    cci:
                      type: array
                      items:
                        type: string
                      example: []
                    cciName:
                      type: string
                      example: null
                    displayNames:
                      type: array
                      items:
                        type: array
                      example:
                        - [
                            "92766-1510043922665",
                            "Enseignants du groupe CollÃ¨ge Charlemagne.",
                            true,
                          ]
                        - [
                            "4e6f1a98-4696-4b9b-be8f-18b3a372a555",
                            "Bernard Briand (principal)",
                            false,
                          ]
                    date:
                      type: integer
                      example: 1676039126037
                    unread:
                      type: boolean
                      example: true
                    response:
                      type: boolean
                      example: false
                    count:
                      type: integer
                      example: 13
                    hasAttachment:
                      type: boolean
                      example: false
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/threads/list:
    get:
      tags:
        - conversation
      summary: Get a list of conversation threads
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                      example: ec401f74-092a-4e98-a1e8-ee9df2d35413
                    date:
                      type: integer
                      example: 1669375921007
                    subject:
                      type: string
                      example: "Invitation RÃ©union Ã©quipe enseignante"
                    displayNames:
                      type: array
                      items:
                        type: array
                      example:
                        - [
                            "412d7ea2-1478-436a-ac33-2b088cb58bfe",
                            "Alban Kerloc'h (directeur de l'Ã©cole)",
                            false,
                          ]
                        - [
                            "e120c8be-ce7b-4f2d-9926-38fc4b9c8126",
                            "CORDIER Bruno",
                            false,
                          ]
                    to:
                      type: array
                      items:
                        type: string
                      example: []
                    from:
                      type: string
                      example: 412d7ea2-1478-436a-ac33-2b088cb58bfe
                    cc:
                      type: string
                      nullable: true
                    cci:
                      type: array
                      items:
                        type: string
                      example:
                        - e120c8be-ce7b-4f2d-9926-38fc4b9c8126
                    unread:
                      type: integer
                      example: 0
                    cciName:
                      type: array
                      example: []
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/thread/messages/{id}:
    get:
      tags:
        - thread
      summary: Get messages in a thread
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: ID of the target thread
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                      example: "3fc5e9c3-d4ca-4966-b200-0274e3df93bb"
                    parent_id:
                      type: string
                      example: null
                    subject:
                      type: string
                      example: "JournÃ©es pÃ©dagogiques 2022-2023"
                    body:
                      type: string
                      example: '<div class="ng-scope">...</div>'
                    from:
                      type: string
                      example: "4e6f1a98-4696-4b9b-be8f-18b3a372a555"
                    fromName:
                      type: string
                      example: null
                    to:
                      type: array
                      items:
                        type: string
                      example:
                        - "92766-1510043922665"
                    toName:
                      type: string
                      example: null
                    cc:
                      type: array
                      items:
                        type: string
                      example: []
                    ccName:
                      type: string
                      example: null
                    cci:
                      type: array
                      items:
                        type: string
                      example: []
                    cciName:
                      type: string
                      example: null
                    displayNames:
                      type: array
                      items:
                        type: array
                      example:
                        - [
                            "92766-1510043922665",
                            "Enseignants du groupe CollÃ¨ge Charlemagne.",
                            true,
                          ]
                        - [
                            "4e6f1a98-4696-4b9b-be8f-18b3a372a555",
                            "Bernard Briand (principal)",
                            false,
                          ]
                    date:
                      type: integer
                      example: 1669395064628
                    thread_id:
                      type: string
                      example: "3fc5e9c3-d4ca-4966-b200-0274e3df93bb"
                    unread:
                      type: boolean
                      example: false
                    attachments:
                      type: array
                      items:
                        type: object
                        properties:
                          id:
                            type: string
                            example: "75c30001-78e0-45b2-856b-ff9bee0f766c"
                          name:
                            type: string
                            example: "file"
                          charset:
                            type: string
                            example: "UTF-8"
                          filename:
                            type: string
                            example: "Informations instituionnelles 2022-2023.pdf"
                          contentType:
                            type: string
                            example: "application/pdf"
                          contentTransferEncoding:
                            type: string
                            example: "7bit"
                          size:
                            type: integer
                            example: 4216718
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/thread/previous-messages/{id}:
    get:
      tags:
        - thread ðŸš§
      summary: ðŸš§ //TODO
      description: ðŸš§ //TODO
      parameters:
        - name: id
          in: path
          required: true
          style: simple
          explode: false
          schema:
            type: string
      responses:
        "200":
          description: Successful response
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/thread/new-messages/{id}:
    get:
      tags:
        - thread ðŸš§
      summary: ðŸš§ //TODO
      description: ðŸš§ //TODO
      parameters:
        - name: id
          in: path
          required: true
          style: simple
          explode: false
          schema:
            type: string
      responses:
        "200":
          description: Successful response
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/thread/trash:
    put:
      tags:
        - thread ðŸš§
      summary: ðŸš§ //TODO
      description: ðŸš§ //TODO
      responses:
        "200":
          description: Successful response
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/thread/toggleUnread:
    post:
      tags:
        - conversation
      summary: Toggle unread status for messages
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: array
                  items:
                    type: string
                  example:
                    - "148b7b23-9154-4bfa-9a3f-934a65c6784a"
                unread:
                  type: boolean
                  example: true
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema: {}
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/count/{folder}:
    get:
      tags:
        - folder
      summary: Get the count of conversations in a folder
      parameters:
        - name: folder
          in: path
          required: true
          style: simple
          explode: false
          schema:
            type: string
        - in: query
          name: unread
          schema:
            type: boolean
          description: Flag to filter unread conversations (true or false)
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  count:
                    type: integer
                    example: 12
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/visibles:
    post:
      tags:
        - conversation ðŸš§
      summary: ðŸš§ //TODO
      description: ðŸš§ //TODO
      responses:
        "200":
          description: Successful response
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/message/{id}:
    get:
      tags:
        - conversation
      summary: Get a conversation message by ID
      parameters:
        - name: id
          in: path
          required: true
          style: simple
          explode: false
          schema:
            type: string
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    example: 3fc5e9c3-d4ca-4966-b200-0274e3df93bb
                  parent_id:
                    type: string
                    nullable: true
                  subject:
                    type: string
                    example: "JournÃ©es pÃ©dagogiques 2022-2023"
                  body:
                    type: string
                    example: '<div class="ng-scope">...</div>'
                  from:
                    type: string
                    example: 4e6f1a98-4696-4b9b-be8f-18b3a372a555
                  fromName:
                    type: string
                    nullable: true
                  to:
                    type: array
                    items:
                      type: string
                    example:
                      - "92766-1510043922665"
                  toName:
                    type: string
                    nullable: true
                  cc:
                    type: array
                    items:
                      type: string
                    example: []
                  ccName:
                    type: string
                    nullable: true
                  displayNames:
                    type: array
                    items:
                      type: array
                    example:
                      - [
                          "92766-1510043922665",
                          "Enseignants du groupe CollÃ¨ge Charlemagne.",
                          true,
                        ]
                      - [
                          "4e6f1a98-4696-4b9b-be8f-18b3a372a555",
                          "Bernard Briand (principal)",
                          false,
                        ]
                  state:
                    type: string
                    example: "SENT"
                  date:
                    type: integer
                    example: 1669395064628
                  language:
                    type: string
                    example: "fr"
                  text_searchable:
                    type: string
                    example: "'-2023':4A '2022':3A,72B 'a':24B,53B,99B,123B 'amont':82B ..."
                  thread_id:
                    type: string
                    example: "3fc5e9c3-d4ca-4966-b200-0274e3df93bb"
                  cci:
                    type: array
                    items:
                      type: string
                    example: []
                  cciName:
                    type: string
                    nullable: true
                  attachments:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          example: "75c30001-78e0-45b2-856b-ff9bee0f766c"
                        name:
                          type: string
                          example: "file"
                        charset:
                          type: string
                          example: "UTF-8"
                        filename:
                          type: string
                          example: "Informations instituionnelles 2022-2023.pdf"
                        contentType:
                          type: string
                          example: "application/pdf"
                        contentTransferEncoding:
                          type: string
                          example: "7bit"
                        size:
                          type: integer
                          example: 4216718
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/trash:
    put:
      tags:
        - conversation
      summary: Move messages to trash
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: array
                  items:
                    type: string
                  example:
                    - "3fc5e9c3-d4ca-4966-b200-0274e3df93bb"
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema: {}
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/restore:
    put:
      tags:
        - conversation
      summary: Restore messages from trash
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: array
                  items:
                    type: string
                  example:
                    - "3fc5e9c3-d4ca-4966-b200-0274e3df93bb"
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema: {}
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/delete:
    put:
      tags:
        - conversation ðŸš§
      summary: ðŸš§ //TODO
      description: ðŸš§ //TODO
      responses:
        "200":
          description: Successful response
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/emptyTrash:
    delete:
      tags:
        - conversation
      summary: Empty trash from message
      responses:
        "200":
          description: Successful response
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/toggleUnread:
    post:
      tags:
        - conversation ðŸš§
      summary: ðŸš§ //TODO
      description: ðŸš§ //TODO
      responses:
        "200":
          description: Successful response
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/max-depth:
    get:
      tags:
        - conversation
      summary: Get the maximum depth of conversations
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  max-depth:
                    type: integer
                    example: 3
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/folders/list:
    get:
      tags:
        - folder ðŸš§
      summary: ðŸš§ //TODO
      description: ðŸš§ //TODO
      responses:
        "200":
          description: Successful response
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/userfolders/list:
    get:
      tags:
        - folder
      summary: Get a list of user folders
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                      example: "861dedd4-e5d9-4147-b89d-3715af15e2cc"
                    parent_id:
                      type: string
                      example: null
                    depth:
                      type: integer
                      example: 1
                    name:
                      type: string
                      example: "Test"
                    nbUnread:
                      type: integer
                      example: 0
                    skip_uniq:
                      type: boolean
                      example: false
                    trashed:
                      type: boolean
                      example: false
                    user_id:
                      type: string
                      example: "8d5313b4-acb4-406c-ab35-87d5e7b0fabe"
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/folder:
    post:
      tags:
        - folder
      summary: Create a new folder
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  example: "Test"
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    example: "861dedd4-e5d9-4147-b89d-3715af15e2cc"
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/folder/{folderId}:
    put:
      tags:
        - folder ðŸš§
      summary: ðŸš§ //TODO
      description: ðŸš§ //TODO
      parameters:
        - name: folderId
          in: path
          required: true
          style: simple
          explode: false
          schema:
            type: string
      responses:
        "200":
          description: Successful response
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/move/userfolder/{folderId}:
    put:
      tags:
        - folder
      summary: Move messages to a user folder
      parameters:
        - name: folderId
          in: path
          required: true
          style: simple
          explode: false
          schema:
            type: string
          description: ID of the target user folder
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: array
                  items:
                    type: string
                  example:
                    - "308bea6d-ada6-4796-8f71-5ff2afe23c3a"
                  description: Message Id
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema: {}
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
    delete:
      tags:
        - conversation ðŸš§
      summary: ðŸš§ //TODO
      description: ðŸš§ //TODO
      parameters:
        - name: folderId
          in: path
          required: true
          style: simple
          explode: false
          schema:
            type: string
      responses:
        "200":
          description: Successful response
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/move/root:
    put:
      tags:
        - conversation ðŸš§
      summary: ðŸš§ //TODO
      description: ðŸš§ //TODO
      responses:
        "200":
          description: Successful response
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/folder/trash/{folderId}:
    put:
      tags:
        - folder ðŸš§
      summary: ðŸš§ //TODO
      description: ðŸš§ //TODO
      parameters:
        - name: folderId
          in: path
          required: true
          style: simple
          explode: false
          schema:
            type: string
      responses:
        "200":
          description: Successful response
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/folder/restore/{folderId}:
    put:
      tags:
        - folder ðŸš§
      summary: ðŸš§ //TODO
      description: ðŸš§ //TODO
      parameters:
        - name: folderId
          in: path
          required: true
          style: simple
          explode: false
          schema:
            type: string
      responses:
        "200":
          description: Successful response
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/message/{id}/attachment:
    post:
      tags:
        - message ðŸš§
      summary: ðŸš§ //TODO
      description: ðŸš§ //TODO
      parameters:
        - name: id
          in: path
          required: true
          style: simple
          explode: false
          schema:
            type: string
      responses:
        "200":
          description: Successful response
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/message/{id}/attachment/{attachmentId}:
    get:
      tags:
        - message
      summary: Get an attachment from a message
      parameters:
        - name: id
          in: path
          required: true
          style: simple
          explode: false
          schema:
            type: string
        - name: attachmentId
          in: path
          required: true
          style: simple
          explode: false
          schema:
            type: string
      responses:
        "200":
          description: Successful response
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
    delete:
      tags:
        - message ðŸš§
      summary: ðŸš§ //TODO
      description: ðŸš§ //TODO
      parameters:
        - name: id
          in: path
          required: true
          style: simple
          explode: false
          schema:
            type: string
        - name: attachmentId
          in: path
          required: true
          style: simple
          explode: false
          schema:
            type: string
      responses:
        "200":
          description: Successful response
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/message/{id}/allAttachments:
    get:
      tags:
        - message ðŸš§
      summary: ðŸš§ //TODO
      description: ðŸš§ //TODO
      parameters:
        - name: id
          in: path
          required: true
          style: simple
          explode: false
          schema:
            type: string
      responses:
        "200":
          description: Successful response
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
  /conversation/message/{id}/forward/{forwardedId}:
    put:
      tags:
        - message ðŸš§
      summary: ðŸš§ //TODO
      description: ðŸš§ //TODO
      parameters:
        - name: id
          in: path
          required: true
          style: simple
          explode: false
          schema:
            type: string
        - name: forwardedId
          in: path
          required: true
          style: simple
          explode: false
          schema:
            type: string
      responses:
        "200":
          description: Successful response
        "302":
          description: Authentification failed. HTTP Client is redirect to $SERVER_DOMAIN/auth/login?callback=$SERVER_DOMAIN/conversation/visible
components:
  schemas:
    conversationVisible:
      required:
        - groups
        - users
      type: object
      properties:
        groups:
          type: array
          items:
            $ref: "#/components/schemas/VisibleGroup"
        users:
          type: array
          items:
            $ref: "#/components/schemas/VisibleUser"
    VisibleUser:
      required:
        - displayName
        - id
        - profile
      type: object
      properties:
        id:
          type: string
        displayName:
          type: string
        profile:
          type: string
          enum:
            - Student
            - Teacher
            - Relative
            - Personel
            - Guest
        groupDisplayName:
          type: string
        structureyName:
          type: string
    VisibleGroup:
      required:
        - groupDisplayName
        - id
        - name
        - profile
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        profile:
          type: string
          enum:
            - Student
            - Teacher
            - Relative
            - Personel
            - Guest
            - Manual
        groupDisplayName:
          type: string
        structureyName:
          type: string
    Error:
      required:
        - message
      type: object
      properties:
        message:
          type: string
          description: A human readable error message
  securitySchemes:
    oAuth2AuthCode:
      type: oauth2
      description: "For more information, see https://opendigitaleducation.atlassian.net/wiki/spaces/PUBLIC/pages/1184891013/Connecteur+-+SSO+oAuth2"
      flows:
        authorizationCode:
          authorizationUrl: /auth/oauth2/auth
          tokenUrl: /auth/oauth2/token
          scopes:
            userinfo: Get user's identification informations
            conversation: Acces to convsersation API
